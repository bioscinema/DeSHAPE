% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/deshape_glm_resid_test.R
\name{deshape_glm_resid_test}
\alias{deshape_glm_resid_test}
\title{DeSHAPE GLM-Residual Group Shape Test}
\usage{
deshape_glm_resid_test(
  formula,
  data,
  mode = c("center", "dispersion", "skewness"),
  family = gaussian(),
  group,
  alternative = c("two.sided", "greater", "less"),
  q = 0.25,
  B = 999,
  seed = NULL
)
}
\arguments{
\item{formula}{A model \code{\link[stats]{formula}} passed to
\code{\link[stats]{glm}}.}

\item{data}{Data frame containing variables referenced in
\code{formula} and the grouping variable.}

\item{mode}{Character string indicating which aspect of residual
shape to test; one of \code{"center"}, \code{"dispersion"},
\code{"skewness"}.  See *Test statistics*.}

\item{family}{A GLM family object (default
\code{\link[stats]{gaussian}}).}

\item{group}{**Character string** giving the column name in
\code{data} that defines the groups whose residual shapes are
compared.}

\item{alternative}{Alternative hypothesis:
\code{"two.sided"} (default), \code{"greater"}, or \code{"less"}.}

\item{q}{Lower-tail probability used in the inter-quantile
contrasts; must satisfy \eqn{0 < q < 0.5}.  Default \code{0.25}.}

\item{B}{Integer; number of label permutations (default
\code{999}).}

\item{seed}{Optional integer seed for reproducibility.}
}
\value{
A list with components
\describe{
  \item{\code{statistic}}{Observed test statistic \eqn{T}.}
  \item{\code{p.value}}{Permutation \eqn{p}\,-value.}
  \item{\code{T_perm}}{Vector of permuted statistics
        (length \code{B}).}
  \item{\code{mode}}{Requested shape aspect.}
  \item{\code{method}}{Description of the test.}
  \item{\code{B}}{Number of permutations performed.}
}
}
\description{
Applies the **DeSHAPE** framework to *response* residuals from a
generalized-linear model (GLM) in order to compare distributional
*shape* features—location, dispersion, or skewness—across
user-defined groups.  The procedure
\enumerate{
  \item fits the GLM specified by \code{formula} and extracts raw
        response residuals;
  \item computes a group-specific summary statistic targeting the
        selected shape aspect (\code{"center"}, \code{"dispersion"},
        or \code{"skewness"});
  \item forms a cross-group sum-of-squares contrast statistic,
        \eqn{T};
  \item constructs a permutation reference distribution for
        \eqn{T} by re-shuffling group labels \code{B} times;
  \item returns the observed statistic together with its permutation
        \eqn{p}\,-value.
}
The test generalises the original DeSHAPE methodology to any GLM
handled by \code{\link[stats]{glm}} (e.g.\ Gaussian, Poisson,
binomial) and is particularly useful when covariates must be adjusted
prior to shape comparison.
}
\details{
The sum-of-squares statistic aggregates deviations of each
group-level summary from the overall summary.  Under the null
hypothesis of equal residual shape across groups, label permutation
yields an exact test when residuals are exchangeable and an
asymptotically valid test otherwise.
}
\section{Test statistics}{

\describe{
  \item{\code{mode = "center"}}{Group median of residuals.}
  \item{\code{mode = "dispersion"}}{Inter-quantile range
        \eqn{Q_{1-q} - Q_q}.}
  \item{\code{mode = "skewness"}}{Quantile-based third-order contrast
        \eqn{Q_{1-q} - 2Q_{0.5} + Q_q}.}
}
}

\examples{
\donttest{
set.seed(123)
n  <- 120
g  <- gl(3, n/3, labels = c("A", "B", "C"))
x1 <- rnorm(n)
y  <- 0.5 + 1.2 * x1 + rnorm(n, sd = 0.8)      # Gaussian GLM
dat <- data.frame(y, x1, g)

# Test equality of residual dispersion across groups
out <- deshape_glm_resid_test(y ~ x1,
                              data  = dat,
                              family = gaussian(),
                              group  = "g",
                              mode   = "dispersion",
                              B      = 499)
out$p.value
}
}
